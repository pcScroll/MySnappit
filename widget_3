import * as React from 'react';
import { AllWidgetProps, DataSourceComponent, DataSource, FeatureDataRecord } from 'jimu-core';

export default class MapClickHandler extends React.PureComponent<AllWidgetProps<unknown>, {objectId: number}> {
  state = { objectId: null };

  render() {
    return (
      <div>
        {/* Replace 'YOUR_DATA_SOURCE_ID' with actual data source ID */}
        <DataSourceComponent
          useDataSource={this.props.useDataSources?.[0]}
          onDataSourceInfoChange={(ds: DataSource) => {
            if (ds?.getStatus() === 'LOADED') {
              const features: FeatureDataRecord[] = ds.getSelectedRecords();
              if (features.length > 0) {
                this.setState({ objectId: features[0].attributes.OBJECTID });
              }
            }
          }}
        />
        
        {this.state.objectId && 
          <div>Clicked Feature ObjectID: {this.state.objectId}</div>
        }
      </div>
    );
  }
}
